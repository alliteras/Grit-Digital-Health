!function($,t,n,e){"use strict";if(!t.history.pushState)return $.fn.smoothState=function(){return this},void($.fn.smoothState.options={});if(!$.fn.smoothState){var o=$("html, body"),r=t.console,a={debug:!1,anchors:"a",hrefRegex:"",forms:"form",allowFormCaching:!1,repeatDelay:500,blacklist:".no-smoothState",prefetch:!1,prefetchOn:"mouseover touchstart",cacheLength:0,loadingClass:"is-loading",scroll:!0,alterRequest:function(t){return t},onBefore:function(t,n){},onStart:{duration:0,render:function(t){}},onProgress:{duration:0,render:function(t){}},onReady:{duration:0,render:function(t,n){t.html(n)}},onAfter:function(t,n){}},s={isExternal:function(n){var e=n.match(/^([^:\/?#]+:)?(?:\/\/([^\/?#]*))?([^?#]+)?(\?[^#]*)?(#.*)?/);return"string"==typeof e[1]&&e[1].length>0&&e[1].toLowerCase()!==t.location.protocol?!0:"string"==typeof e[2]&&e[2].length>0&&e[2].replace(new RegExp(":("+{"http:":80,"https:":443}[t.location.protocol]+")?$"),"")!==t.location.host?!0:!1},stripHash:function(t){return t.replace(/#.*/,"")},isHash:function(n,e){e=e||t.location.href;var o=n.indexOf("#")>-1?!0:!1,r=s.stripHash(n)===s.stripHash(e)?!0:!1;return o&&r},translate:function(t){var n={dataType:"html",type:"GET"};return t="string"==typeof t?$.extend({},n,{url:t}):$.extend({},n,t)},shouldLoadAnchor:function(t,n,o){var r=t.prop("href");return!(s.isExternal(r)||s.isHash(r)||t.is(n)||t.prop("target")||typeof o!==e&&""!==o&&-1===t.prop("href").search(o))},clearIfOverCapacity:function(t,n){return Object.keys||(Object.keys=function(t){var n=[],e;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.push(e);return n}),Object.keys(t).length>n&&(t={}),t},storePageIn:function(t,n,e,o){var r=$("<html></html>").append($(e));return t[n]={status:"loaded",title:r.find("title").first().text(),html:r.find("#"+o),doc:e},t},triggerAllAnimationEndEvent:function(t,n){n=" "+n||"";var e=0,o="animationstart webkitAnimationStart oanimationstart MSAnimationStart",r="animationend webkitAnimationEnd oanimationend MSAnimationEnd",a="allanimationend",i=function(n){$(n.delegateTarget).is(t)&&(n.stopPropagation(),e++)},l=function(n){$(n.delegateTarget).is(t)&&(n.stopPropagation(),e--,0===e&&t.trigger(a))};t.on(o,i),t.on(r,l),t.on("allanimationend"+n,function(){e=0,s.redraw(t)})},redraw:function(t){t.height()}},i=function(n){if(null!==n.state){var e=t.location.href,o=$("#"+n.state.id),r=o.data("smoothState");r.href===e||s.isHash(e,r.href)||r.load(e,!1)}},l=function(a,i){var l=$(a),u=l.prop("id"),c=null,f=!1,h={},d=t.location.href,p=function(t){t=t||!1,t&&h.hasOwnProperty(t)?delete h[t]:h={},l.data("smoothState").cache=h},g=function(t,n){n=n||$.noop;var e=s.translate(t);if(h=s.clearIfOverCapacity(h,i.cacheLength),!h.hasOwnProperty(e.url)||"undefined"!=typeof e.data){h[e.url]={status:"fetching"};var o=$.ajax(e);o.success(function(t){s.storePageIn(h,e.url,t,u),l.data("smoothState").cache=h}),o.error(function(){h[e.url].status="error"}),n&&o.complete(n)}},m=function(){if(c){var t=$(c,l);if(t.length){var n=t.offset().top;o.scrollTop(n)}c=null}},y=function(e){var a="#"+u,s=h[e]?$(h[e].html.html()):null;s.length?(n.title=h[e].title,l.data("smoothState").href=e,i.loadingClass&&o.removeClass(i.loadingClass),i.onReady.render(l,s),l.one("ss.onReadyEnd",function(){f=!1,i.onAfter(l,s),i.scroll&&m()}),t.setTimeout(function(){l.trigger("ss.onReadyEnd")},i.onReady.duration)):!s&&i.debug&&r?r.warn("No element with an id of "+a+" in response from "+e+" in "+h):t.location=e},v=function(n,e,a){var c=s.translate(n);"undefined"==typeof e&&(e=!0),"undefined"==typeof a&&(a=!0);var f=!1,d=!1,m={loaded:function(){var n=f?"ss.onProgressEnd":"ss.onStartEnd";d&&f?d&&y(c.url):l.one(n,function(){y(c.url),a||p(c.url)}),e&&t.history.pushState({id:u},h[c.url].title,c.url),d&&!a&&p(c.url)},fetching:function(){f||(f=!0,l.one("ss.onStartEnd",function(){i.loadingClass&&o.addClass(i.loadingClass),i.onProgress.render(l),t.setTimeout(function(){l.trigger("ss.onProgressEnd"),d=!0},i.onProgress.duration)})),t.setTimeout(function(){h.hasOwnProperty(c.url)&&m[h[c.url].status]()},10)},error:function(){i.debug&&r?r.log("There was an error loading: "+c.url):t.location=c.url}};h.hasOwnProperty(c.url)||g(c),i.onStart.render(l),t.setTimeout(function(){i.scroll&&o.scrollTop(0),l.trigger("ss.onStartEnd")},i.onStart.duration),m[h[c.url].status]()},S=function(t){var n,e=$(t.currentTarget);s.shouldLoadAnchor(e,i.blacklist,i.hrefRegex)&&!f&&(t.stopPropagation(),n=s.translate(e.prop("href")),n=i.alterRequest(n),g(n))},w=function(t){var n=$(t.currentTarget);if(!t.metaKey&&!t.ctrlKey&&s.shouldLoadAnchor(n,i.blacklist,i.hrefRegex)&&(t.stopPropagation(),t.preventDefault(),!P())){C();var e=s.translate(n.prop("href"));f=!0,c=n.prop("hash"),e=i.alterRequest(e),i.onBefore(n,l),v(e)}},E=function(t){var n=$(t.currentTarget);if(!n.is(i.blacklist)&&(t.preventDefault(),t.stopPropagation(),!P())){C();var o={url:n.prop("action"),data:n.serialize(),type:n.prop("method")};f=!0,o=i.alterRequest(o),"get"===o.type.toLowerCase()&&(o.url=o.url+"?"+o.data),i.onBefore(n,l),v(o,e,i.allowFormCaching)}},b=0,P=function(){var t=null===i.repeatDelay,n=parseInt(Date.now())>b;return!(t||n)},C=function(){b=parseInt(Date.now())+parseInt(i.repeatDelay)},T=function(t){i.anchors&&(t.on("click",i.anchors,w),i.prefetch&&t.on(i.prefetchOn,i.anchors,S)),i.forms&&t.on("submit",i.forms,E)},A=function(){var t=l.prop("class");l.removeClass(t),s.redraw(l),l.addClass(t)};return i=$.extend({},$.fn.smoothState.options,i),null===t.history.state&&t.history.replaceState({id:u},n.title,d),s.storePageIn(h,d,n.documentElement.outerHTML,u),s.triggerAllAnimationEndEvent(l,"ss.onStartEnd ss.onProgressEnd ss.onEndEnd"),T(l),{href:d,cache:h,clear:p,load:v,fetch:g,restartCSSAnimations:A}},u=function(t){return this.each(function(){var n=this.tagName.toLowerCase();this.id&&"body"!==n&&"html"!==n&&!$.data(this,"smoothState")?$.data(this,"smoothState",new l(this,t)):!this.id&&r?r.warn("Every smoothState container needs an id but the following one does not have one:",this):"body"!==n&&"html"!==n||!r||r.warn("The smoothstate container cannot be the "+this.tagName+" tag")})};t.onpopstate=i,$.smoothStateUtility=s,$.fn.smoothState=u,$.fn.smoothState.options=a}}(jQuery,window,document);